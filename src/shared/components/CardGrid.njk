{% set gridClass = gridClass or 'card-grid' %}
{% set cardClass = cardClass or 'card' %}
{% set columns = columns or 'auto' %}

<section class="section {{ sectionClass }}" {% if sectionId %}id="{{ sectionId }}"{% endif %}>
  <div class="container">
    {% if sectionTitle or sectionDescription %}
    <div class="section-header">
      {% if sectionTitle %}
      <h2 class="section-title">{{ sectionTitle }}</h2>
      {% endif %}
      
      {% if sectionDescription %}
      <p class="section-description">{{ sectionDescription }}</p>
      {% endif %}
    </div>
    {% endif %}
    
    <div class="{{ gridClass }}" {% if columns != 'auto' %}style="--grid-columns: {{ columns }}"{% endif %}>
      {% for card in cards %}
      <div class="{{ cardClass }} {% if card.featured %}card-featured{% endif %}" {% if card.id %}id="{{ card.id }}"{% endif %}>
        {% if card.image %}
        <div class="card-image">
          {% if card.link %}
          <a href="{{ card.link }}" aria-label="Learn more about {{ card.title }}">
          {% endif %}
            <picture>
              {% if card.imageWebP %}
              <source srcset="{{ card.imageWebP }}" type="image/webp">
              {% endif %}
              <img src="{{ card.image }}" alt="{{ card.imageAlt or card.title }}" class="card-img" {% if card.lazy %}loading="lazy"{% else %}loading="eager"{% endif %}>
            </picture>
          {% if card.link %}
          </a>
          {% endif %}
          
          {% if card.badge %}
          <div class="card-badge">{{ card.badge }}</div>
          {% endif %}
        </div>
        {% endif %}
        
        <div class="card-content">
          {% if card.category %}
          <div class="card-category">{{ card.category }}</div>
          {% endif %}
          
          {% if card.title %}
          <h3 class="card-title">
            {% if card.link %}
            <a href="{{ card.link }}">{{ card.title }}</a>
            {% else %}
            {{ card.title }}
            {% endif %}
          </h3>
          {% endif %}
          
          {% if card.description %}
          <p class="card-description">{{ card.description }}</p>
          {% endif %}
          
          {% if card.features %}
          <ul class="card-features">
            {% for feature in card.features %}
            <li class="card-feature">
              <svg class="feature-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>{{ feature }}</span>
            </li>
            {% endfor %}
          </ul>
          {% endif %}
          
          {% if card.price %}
          <div class="card-price">
            {% if card.pricePrefix %}<span class="price-prefix">{{ card.pricePrefix }}</span>{% endif %}
            <span class="price-amount">{{ card.price }}</span>
            {% if card.priceSuffix %}<span class="price-suffix">{{ card.priceSuffix }}</span>{% endif %}
          </div>
          {% endif %}
          
          {% if card.rating %}
          <div class="card-rating" aria-label="Rating: {{ card.rating }} out of 5 stars">
            <div class="stars">
              {% for i in range(1, 6) %}
              <svg class="star {% if i <= card.rating %}star-filled{% endif %}" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="currentColor"/>
              </svg>
              {% endfor %}
            </div>
            {% if card.reviewCount %}
            <span class="rating-count">({{ card.reviewCount }} reviews)</span>
            {% endif %}
          </div>
          {% endif %}
          
          {% if card.cta %}
          <div class="card-actions">
            <a href="{{ card.cta.url }}" class="btn {{ card.cta.class or 'btn-primary' }}" {% if card.cta.external %}target="_blank" rel="noopener noreferrer"{% endif %}>
              {% if card.cta.icon %}
              <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                {{ card.cta.icon | safe }}
              </svg>
              {% endif %}
              {{ card.cta.text }}
            </a>
          </div>
          {% endif %}
          
          {% if card.meta %}
          <div class="card-meta">
            {% for item in card.meta %}
            <span class="meta-item">
              {% if item.icon %}
              <svg class="meta-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                {{ item.icon | safe }}
              </svg>
              {% endif %}
              {{ item.text }}
            </span>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
    
    {% if sectionCTA %}
    <div class="section-cta">
      <a href="{{ sectionCTA.url }}" class="btn {{ sectionCTA.class or 'btn-primary btn-lg' }}">
        {% if sectionCTA.icon %}
        <svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          {{ sectionCTA.icon | safe }}
        </svg>
        {% endif %}
        {{ sectionCTA.text }}
      </a>
    </div>
    {% endif %}
  </div>
</section>

